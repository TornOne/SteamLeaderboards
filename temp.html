<html>
    
    <head>
        <title>PvP Snake</title>
        <meta charset="utf-8" />
        <script>
            loopy = 0

            function first() {
                clearInterval(loopy);
                size = 16, x = 80, y = 45;
                board = document.getElementById("board");
                g = board.getContext("2d");
                t = board.getBoundingClientRect();
                if (document.getElementById("size").value != "") {
                    size = parseInt(document.getElementById("size").value);
                }
                if (document.getElementById("x").value != "") {
                    x = parseInt(document.getElementById("x").value);
                }
                if (document.getElementById("y").value != "") {
                    y = parseInt(document.getElementById("y").value);
                }
                var speed = document.getElementById("select1").value;
                //background
                if (document.getElementById("select1").value == 100) {
                document.body.style.backgroundImage = 'none';
                }
                if (document.getElementById("select1").value == 15) {
                document.body.style.backgroundImage = "url('http://files.gamebanana.com/img/ico/sprays/526290f6342af.png')";
                }
                if (document.getElementById("select1").value == 50) {
                document.body.style.backgroundImage = "url(http://cloud-2.steamusercontent.com/ugc/613900435767624953/F8CCF235814369ED4675A4B196AF64D8420163C5/)";
                }
                if (document.getElementById("select1").value == 25) {
                document.body.style.backgroundImage = "url(http://i.ytimg.com/vi/W6U2714SHx4/maxresdefault.jpg)";
                }   
                if (document.getElementById("select1").value == 250) {
                document.body.style.backgroundImage = "url(http://weknowmemes.com/wp-content/uploads/2012/03/now-thats-just-plain-dangerous.jpg)";
                }  
                if (document.getElementById("select1").value == 750) {
                document.body.style.backgroundImage = "url(http://rs2img.memecdn.com/chess_c_196595.jpg)";
                } 
                board.width = x * size;
                board.height = y * size;
                snake1 = [0, [x - 2, y - 2]];
                snake2 = [0, [1, 1]];
                food = spawn_food();
                game_over = 0;
                loopy = setInterval('looper()', speed);
                spawn_food();
            }

            function draw() {
                g.clearRect(0, 0, x * size, y * size);
                g.fillStyle = "#2A1507";
                for (var f = 0; f < food.length; f++) {
                    g.fillRect(size * food[0], size * food[1], size, size);
                }
                g.fillStyle = "green";
                for (var s = 1; s < snake1.length; s++) {
                    g.fillRect(size * snake1[s][0], size * snake1[s][1], size, size);
                }
                g.fillStyle = "red";
                for (var s = 1; s < snake2.length; s++) {
                    g.fillRect(size * snake2[s][0], size * snake2[s][1], size, size);
                }
            }

            function scorepoints() {
                document.getElementById("score").innerHTML = '<font color="green">' + (snake1.length - 2) + '<font color="black"> - <font color="red">' + (snake2.length - 2)
            }

            function looper() {
                if (game_over == 0) {
                    snake1 = one_move(snake1);
                    snake2 = one_move(snake2);
                    snake1 = grow(snake1);
                    snake2 = grow(snake2);
                    collision();
                    draw();
                    scorepoints();
                }
                if (game_over != 0) {
                    endscreen();
                }
            }

            function endscreen() {
                if (game_over == 1) {
                    alert('green snake has won')
                }
                if (game_over == 2) {
                    alert('red snake has won')
                }
                if (game_over >= 3) {
                    alert('WTF A DRAW ? ? ? ? ? ')
                }
                clearInterval(loopy);
                first();
            }

            function one_move(snake) {
                if (snake[0] == 1) {
                    snake.splice(1, 0, [snake[1][0], snake[1][1] - 1]);
                } else if (snake[0] == 2) {
                    snake.splice(1, 0, [snake[1][0] + 1, snake[1][1]]);
                } else if (snake[0] == 3) {
                    snake.splice(1, 0, [snake[1][0], snake[1][1] + 1]);
                } else if (snake[0] == 4) {
                    snake.splice(1, 0, [snake[1][0] - 1, snake[1][1]]);
                }
                if (snake[0] != 0) {
                    snake.splice(-1, 1);
                }
                return snake;
            }

            function grow(snake) {
                if (snake[1][0] == food[0] && snake[1][1] == food[1]) {
                    draw();
                    food = spawn_food();
                    snake.push(snake[-1]);
                }
                return snake;
            }

            function spawn_food() {
                return [Math.floor(Math.random() * x), Math.floor(Math.random() * y)];
            }

            function collision() {
                if (snake1[1][0] < 0 || snake1[1][0] > x - 1 || snake1[1][1] < 0 || snake1[1][1] > y - 1) {
                    game_over += 2;
                }
                for (var s = 2; s < snake2.length; s++) {
                    if (snake1[1][0] == snake2[s][0] && snake1[1][1] == snake2[s][1]) {
                        game_over += 2;
                    }
                    if (snake2[1][0] == snake2[s][0] && snake2[1][1] == snake2[s][1]) {
                        game_over += 1;
                    }
                }
                if (snake2[1][0] < 0 || snake2[1][0] > x - 1 || snake2[1][1] < 0 || snake2[1][1] > y - 1) {
                    game_over += 1;
                }
                for (var s = 2; s < snake1.length; s++) {
                    if (snake2[1][0] == snake1[s][0] && snake2[1][1] == snake1[s][1]) {
                        game_over += 1;
                    }
                    if (snake1[1][0] == snake1[s][0] && snake1[1][1] == snake1[s][1]) {
                        game_over += 2;
                    }
                }
                if (snake1[1][0] == snake2[1][0] && snake1[1][1] == snake2[1][1]) {
                    game_over += 3;
                }
            }

            document.onkeydown = function(e) {
                switch (e.keyCode) {
                    //space
                    case 32:
                        //var speed = document.getElementById("select1").value;
                        //document.write(speed)

                        snake1[0] = 0;
                        snake2[0] = 0;
                        break;
                        //up
                    case 38:
                        if (snake1[0] != 3) snake1[0] = 1;
                        break;
                        //right
                    case 39:
                        if (snake1[0] != 4) snake1[0] = 2;
                        break;
                        //down
                    case 40:
                        if (snake1[0] != 1) snake1[0] = 3;
                        break;
                        //left
                    case 37:
                        if (snake1[0] != 2) snake1[0] = 4;
                        break;
                        //x
                    case 88:
                        snake2[0] = 0;
                        break;
                        //w
                    case 87:
                        if (snake2[0] != 3) snake2[0] = 1;
                        break;
                        //d
                    case 68:
                        if (snake2[0] != 4) snake2[0] = 2;
                        break;
                        //s
                    case 83:
                        if (snake2[0] != 1) snake2[0] = 3;
                        break;
                        //a
                    case 65:
                        if (snake2[0] != 2) snake2[0] = 4;
                        break;
                }
            }
        </script>
    </head>
    
    <body>
        <div id="score" style="color:green"></div>
        <canvas id="board" width="0" height="0" style="background-color:#BEBEBE"></canvas>
        <br/>
        <input type="button" value="Start" onclick="first()" />
        <div/>
        <br>
        <input type="text" placeholder="16" id="size" />Square size
        <div/>
        <input type="text" placeholder="80" id="x" />Width in squares
        <div/>
        <input type="text" placeholder="45" id="y" />Height in squares
        <div/>select snake speed
        <select id="select1">
            <option value="750">Chess</option>
            <option value="250">Nokia</option>
            <option value="100" selected="selected">Normal</option>
            <option value="50">MLG pro</option>
            <option value="25">Turbo</option>
            <option value="15">3fast5me</option>
        </select>
    </body>

</html>